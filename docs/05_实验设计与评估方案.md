# Phase 4: 实验设计与评估方案

> **Project:** Intelligent Cross-Domain Scheduling for Large Model Training (Task 3)
> **Target:** CCF-A Class Conference (System/AI Track)
> **Version:** v1.0
> **Date:** 2026-01-26

**核心假设**: 同构算力环境（各域 GPU 型号相同），核心挑战聚焦于**跨域网络动态性**与**通信优化**。

---

## 1. 实验目标与评价维度

**目标**: 证明 Hi-PPO 在跨域训练场景下满足 KPI，并优于 SOTA。

**核心 KPI**:
- 域间决策延迟 < 1 秒
- 域内决策延迟 < 100 ms
- 训练周期缩短 ≥ 25%
- 资源利用率提升 ≥ 35%
- 通信成本降低 ≥ 30%
- 网络波动 ±30% 时性能下降 < 10%
- 分层协同响应时间 ≤ 2 秒
- 负载波动 ±20% 时稳定性 ≥ 99%

---

## 2. 实验场景设计

### 2.1 域规模与拓扑

| 场景 | 域数量 K | 每域 GPU | 域间带宽 | 域间延迟 |
|------|-----------|----------|-----------|-----------|
| S1 | 3 | 8 | 2-5 Gbps | 30-80 ms |
| S2 | 5 | 16 | 2-5 Gbps | 20-100 ms |
| S3 | 10 | 32 | 1-3 Gbps | 20-120 ms |

### 2.2 网络动态性

**带宽模型**:
$$B_{ij}(t) = B_{ij}^{base} \cdot (1 + \epsilon_{ij}(t)), \quad \epsilon_{ij}(t) \in [-0.3, 0.3]$$

**动态模式**:
- 短时抖动（秒级）
- 周期性波动（分钟级）
- 突发拥塞（step change）

### 2.3 资源受限下的评估策略（补充）

由于真实集群资源有限，实验以**高保真仿真为主**，并通过小规模校准提高可信度：

1. **Astra-sim 作为主评估**（论文结果基于仿真）  
2. **小规模微基准校准**（单机或少量 GPU）  
3. **参数敏感性分析**（带宽/延迟/负载波动范围）  
4. **限制声明**：论文明确“无大规模真实集群，结果基于高保真仿真”

---

## 3. 训练任务配置

| 模型规模 | 代表模型 | 层数 | 目标并行策略 |
|----------|----------|------|--------------|
| 中等 | LLaMA-7B | 32 | DP+PP |
| 大 | LLaMA-70B | 96 | DP+TP+PP |
| 超大 | 405B | 120+ | DP+TP+PP |

---

## 4. 基线方法（SOTA）

- **MAST (OSDI'24)**: 跨域全局调度
- **Sailor (SOSP'25)**: 动态集群调度
- **CrossPipe**: 跨域流水线优化
- **Crux**: 通信调度优化
- **DiLoCo**: 低通信训练
- **Heuristic**: 静态/贪心调度

---

## 5. 实验指标体系

| 类别 | 指标 | 说明 |
|------|------|------|
| 效率 | $T_{step}$ | 全局步长时间 |
| 效率 | Throughput | Samples/sec 或 Tokens/sec |
| 成本 | $C_{comm}$ | 跨域通信成本 |
| 资源 | GPU Util | $\frac{T_{compute}}{T_{total}}$ |
| 鲁棒性 | $\\Delta T_{step}$ | 网络波动前后差异 |
| 决策 | Latency | 代理决策耗时 |
| 可解释性 | Case Study | 解释性输出与决策依据示例 |

---

## 6. 消融实验

### 6.1 组件消融
- 去除 GNN 编码，仅使用平铺带宽矩阵
- 去除上层策略（仅域内调度）
- 固定权重 vs 动态权重

### 6.2 动态适应消融
- 关闭网络预测模块
- 关闭动作 Masking

---

## 7. 统计显著性与可复现性

- 每个配置重复至少 5 次
- 报告均值与 95% 置信区间
- 提供随机种子与环境配置文件

---

## 9. 平台可部署性说明（补充）

- 输出调度策略与配置文件接口（JSON/YAML）  
- 可接入平台资源监控 API（作为环境状态输入）  
- 支持离线训练 + 在线推理模式

---

## 8. 实验输出与可视化

**推荐图表**:
- 训练时间对比柱状图
- 通信成本折线图（随时间变化）
- 不同域规模下的性能趋势图
- 决策延迟分布箱线图

---

*本文件为 Phase 4 实验设计的统一规范* 
